---
title: "CBxResponsbility_Preprocessing"
author: "Carson Koffler"
format: html
editor: visual
---

## Study Background

### Quick Abstract

### Design

### Power Analysis

I will be relying on the effect size past experimenters received from using Cyberball to manipulate envy. We will likely have a bigger sample than what this requires.

> "Participants in the high-envy condition (M = 3.22, SD = 1.7) endorsed more state envy towards Standard Player 2 than did participants in the low-envy condition (M = 2.1, SD = 1.42; β = 0.33, b = 1.10, SE = 0.15, p \< .001)."

```{r pwr_t_test}
library(pwr)
## calculate cohen's d 
m1 = 3.22
s1 = 1.7
m2 = 2.1
s2 = 1.42
s_pooled = sqrt(((s1^2)+(s2^2))/2)
d = (m1-m2)/s_pooled

#power analysis to find required sample size
cat("Cohen's d is", d)
print(pwr.t.test(n = NULL, d=d, sig.level = 0.05, power = .8, 
           type = "two.sample", alternative = "two.sided"))



print(pwr.t.test(n = NULL, d=.62, sig.level = 0.05, power = .8, 
           type = "two.sample", alternative = "two.sided"))


cat("Assuming Tang et al., Total sample size = ", 32*4)
cat("\nAssuming Poon et al., Total sample size = ", 41.81934*4)


x <- (pwr.t.test(n = NULL, d=.3, sig.level = 0.05, power = .9, 
           type = "two.sample", alternative = "two.sided"))

cat("\n\nAssuming d = .3 and power = .90, we need a sample of", x$n *4)

y <- (pwr.t.test(n = NULL, d=.3, sig.level = 0.05, power = .95, 
           type = "two.sample", alternative = "two.sided"))
cat("\nAssuming d = .3 and power = .95, we need a sample of", y$n *4)

z <- (pwr.t.test(n = NULL, d=.3, sig.level = 0.05, power = .80, 
           type = "two.sample", alternative = "two.sided"))
cat("\nAssuming d = .3 and power = .80, we need a sample of", z$n *4)







```

```{r pwr_anova_test}
z <- pwr.anova.test(
  k = 4,
  f = 0.1,
  sig.level = 0.05,
  power = 0.80
)

z

(z$n)*4 


x <- pwr.anova.test(
  k = 4,
  f = 0.1,
  sig.level = 0.05,
  power = 0.90
)

print(x)

(x$n)*4 

y <- pwr.anova.test(
  k = 4,
  f = 0.1,
  sig.level = 0.05,
  power = 0.95
)

y 

(y$n)*4
```

### Hypotheses

In the hypotheses below, episodic envy and anger are treated both as outcomes of the experimental manipulation and as predictors of behavior in the money-burning task. 

Inequity –\> Envy

| Hypothesis 1a (Inequity Effect on Envy): Participants who experience inequity will report higher levels of episodic envy toward SP2 than participants who experience equitable conditions, regardless of whether SP2 was responsible for the inequity.\\
| Hypothesis 1b (Source of Equity on Envy): When final earnings are equal, envy will not differ significantly, regardless of the source of equity (i.e., envy in conditions 1 and 4 should not be significantly different). 

Responsibility -\> Anger

| Hypothesis 2 (Responsibility Effect on Anger): Participants will report more episodic anger only when SP2 could have corrected inequity but did not (Condition 3), compared to other conditions. 

Individual Differences on Money Burning

| Hypothesis 3 (Envy on Money Burning): Higher levels of episodic envy will predict greater willingness to incur monetary costs in order to reduce SP2’s earnings.
| 
| Hypothesis 4 (Anger on Money Burning): Higher levels of episodic anger will predict greater willingness to incur monetary costs in order to reduce SP2’s earnings. 

Inequity on Money Burning

| Hypothesis 5 (Inequity on Money Burning; Envy-Driven Money Burning): Participants who experience disadvantageous inequity will be more willing to incur personal costs to reduce SP2’s earnings than those who experience equity.

Responsibility on Money Burning

| Hypothesis 6 (Expectation-Violation on Money Burning; Anger-Driven Money Burning): Participants who experience inequity that could have been corrected but was not (Condition 3) will be more willing to incur personal costs to reduce SP2’s earnings than participants in all other conditions.

## Results

### Data Preparation

[Carson, see if you can add a variable for the trial time for the slider task specifically. I am curious if people who decided *not* to burn spent longer making that decision...]{style="color:red"}

```{r opening_file}
#| echo: false

#### Load Relevant Libraries and Functions
library(jsonlite)
library(dplyr)
library(tidyr)
library(purrr)
library(stringr)
library(readr)
library(kableExtra)
library(ggplot2)

#### Import data
# Set working directory
path <- "/Users/carsonkoffler/Documents/Envy/Cyberball/CyberballXResponsibility/Data/PilotB"
setwd(path)

files <- list.files(path = path, pattern = "\\.csv$", full.names = T) #list all files folder

length(files) #number of files --> should match n 

head(files) #View

#read and combine participant data into one file 
all_data <- files %>%
  map_dfr(function(file_path){
    read_csv(
      file_path,
      col_types = cols(
        prolific_id_last4 = col_character(),  # force character type
        .default = col_guess()                # let all other columns be guessed
      )
    )
  })

all_data <- as_tibble(all_data)

#collect whether or not participants needed more than one try on quiz 
quiz_attempts <- all_data %>%
  filter(task == "comprehension_quiz") %>%
  arrange(subject_id, trial_index)

quiz_summary <- quiz_attempts %>%
  group_by(subject_id) %>%
  summarise(
    n_attempts = n(),
    passed_first_try = first(correct),
    ever_failed = any(correct == FALSE),
    .groups = "drop"
  )



#summarize participant data 
participants <- all_data %>%
  group_by(subject_id) %>%
  summarise(success = first(success), #complete = T/F
            experiment_data = first(experiment_date), #date study done
            exp_condition = first(condition), #condition: 1,2,3,4
            total_time = max(time_elapsed, na.rm = T), # total time to complete study
            sp1_points = first(sp1Points), 
            sp2_points = first(sp2Points),
            sp1_dollars = first(sp1Dollars),
            sp2_dollars = first(sp2Dollars), 
            burn_amount = first(burn_amount),
            prolific_id = first(prolific_id_last4),  #Last 4 of prolific id
            version = first(version)) #study version 

            ## need to figure out the From: and To: variables --> this can let me track if in
            ## condition 4 if SP1 passes to SP2 
            df_throws_list <- 
              all_data %>%
              filter(!is.na(from) & !is.na(to)) %>%
              group_by(subject_id) %>%
              summarise(
                throws = list(tibble(
                  cb_throws = trial_index,
                  from  = from,
                  to    = to
                )),
                .groups = "drop"
              ) 
            
            df_throws_list %>%
              unnest(throws)
            
            df_throws_list <- 
              all_data %>%
              filter(!is.na(from) & !is.na(to)) %>%
              select(subject_id, trial_index, condition,burn_amount, from, to)

# Identify survey rows want to keep
survey_data <- all_data %>%
  dplyr::filter(str_detect(trial_type, "survey")) %>%
  dplyr::select(subject_id, trial_type, response)

# Convert JSON strings to lists and expand (1 column per Q)
survey_expanded <- survey_data %>%
  mutate(response_list = map(response, ~ {
    # Convert string JSON to R list
    if (!is.na(.x) && .x != "") {
      as.list(fromJSON(.x))
    } else {
      NA
    }
  })) %>%
  dplyr::select(-response) %>%
  unnest_wider(response_list)


# # fix data that was not named (Q0 contains psuedonym)
# columns_fixed <- survey_expanded %>%
#   group_by(subject_id) %>%
#   summarise(
#     pseudonym = Q0[!map_lgl(Q0, is.null)][1],
#   )
# 
# #join columns_fixed to survey_expanded
# survey_expanded <- survey_expanded %>%
#   left_join(columns_fixed, by = "subject_id")
# 
# #add attention check 1 that was filtered out earlier
# attention_check_1 <- all_data %>%
#   filter(str_detect(stimulus, "Who won the last round you played\\?")) %>%
#   dplyr::select(subject_id, attention_check_1=response)
# 
# #add attention check 1 to the df 
# survey_expanded <- survey_expanded %>%
#   left_join(attention_check_1, by = "subject_id")
# 
# #rename attention check 2 to fit format 
# survey_expanded <- survey_expanded %>% 
#   rename(attention_check_2 = DV5_attention_check, 
#          psuedonum = Q0)
# 
# 
# # Join expanded survey data back to main dataframe
# # If multiple survey rows per subject, we can summarize by taking the first non-NA per column
df <- survey_expanded %>%
  group_by(subject_id) %>%
  summarise(across(everything(), ~ first(na.omit(.x)), .names = "{.col}"))

#add in the quiz data 
df <- df %>%
  left_join(quiz_summary, by = "subject_id")

df <- df %>%
  left_join(participants, by = "subject_id") ## df is now completed df 

```

Quick overview of what data looks like

```{r demo_visualizations}
#| echo: false
library(ggplot2)

#visualization of demographics 

#age
df$demo_age <- as.numeric(df$demo_age)
summary(df$demo_age)
#histogram
ggplot(data = df, aes(x= demo_age))+
  geom_histogram() +
  labs(
    title = "Distribution of Participant Ages",
    x = "Age", 
    y = "Count")+
  theme_minimal()

#gender 
#plot gender 
table(df$demo_gender)
#histogram
ggplot(data = df, aes(x= demo_gender))+
  geom_bar(fill = "#39568CFF") +
  labs(
    title = "Number of Participant's by Gender", 
    x = "Gender", 
    y = "Count")+
  theme_minimal()

#total time 
#plot time taken
summary(df$total_time/60000) #time taken in minutes ms:min --> 60000:1 
#plot
ggplot(data = df, aes(x= total_time/60000))+
  geom_density(fill = "#39568CFF") +
  labs(
    title = "Amount of Time Taken to Complete Survey",
    x = "Time to Complete Survey (minutes)", 
    y = "Count")+
  theme_minimal()


#conditions
#plot conditions 
table(df$exp_condition)

ggplot(data = df, aes(x= factor(exp_condition)))+
  geom_bar(fill = "#39568CFF") +
  labs(
    title = "Number of Participants in the Game Conditions",
    x = "Random Conditon", 
    y = "Count")+
  theme_minimal()

#attention checks 
data_complete <- df %>%
  filter(success == "TRUE")

#pass the quiz?
table(df$n_attempts)
## this will be a good indicator of how difficult it is for people to understand quiz
ggplot(data = df, aes(x= n_attempts))+
  geom_bar() +
  geom_text(aes(label = after_stat(count)), stat = "count", vjust = -0.3) +
  labs(
    title = "Number of Attempts Needed to Pass Instruction Quiz", 
    x = "Number of Attempts", 
    y = "Count")+
  theme_minimal() + 
  theme(plot.title = element_text(hjust = 0.5))

#are different conditions struggling more? 
ggplot(df, aes(x = n_attempts)) +
  geom_bar(fill = "steelblue") +
  facet_wrap(~ exp_condition) +
  labs(
    title = "Number of Attempts by Experimental Condition",
    x = "Number of Attempts",
    y = "Count"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))


#excluded if more than 1 attention check is failed (need to pass more than 2)
#create pass/fail for attention_check_1
data_complete <- data_complete %>%
  mutate(
    comprehension_check = case_when(
      # equitable T, received ball 8
      (exp_condition == 1 & SP1_ball_received_T == 8) ~ "pass",
      #inequitable T, received ball 4
      (exp_condition == 2 & SP1_ball_received_T == 4) ~ "pass",
      #inequitable T, received ball 4
      (exp_condition == 3 & SP1_ball_received_T == 4) ~ "pass",
      #inequitable T, received ball 4
      (exp_condition == 4 & SP1_ball_received_T == 4) ~ "pass",
      TRUE ~ "fail"
    )
  )



```

### Main Analyses

```{r composites}
#reverse code 
df$dv4_trade_places_calc <- 6 - df$dv4_trade_places_rev
df$dv4_content_with_self_calc <- 6 - df$dv4_content_with_self_rev
df$dv4_happy_friends_succeed_calc <- 6 - df$dv4_happy_friends_succeed_rev
df$dv4_happy_others_succeed_calc <- 6 - df$dv4_happy_others_succeed_rev

#trait envy
df$trait_envy <- (df$dv4_angry_others_succeed +
                  df$dv4_content_with_self_calc +
                  df$dv4_happy_friends_succeed_calc +
                  df$dv4_happy_others_succeed_calc +
                  df$dv4_pain_friends_succeed +
                  df$dv4_prefer_stranger_win +
                  df$dv4_rain_on_parade +
                  df$dv4_trade_places_calc)/8


#state envy composite
df$state_envy_composite <- (df$dv3_state_envy +
                            df$dv3_state_jealous +
                            df$dv3_state_resentful +
                            df$dv3_state_bitter)/4 

#state anger composite 
df$state_anger_composite <- (df$dv3_state_angry +
                            df$dv3_state_annoyed +
                            df$dv3_state_upset +
                            df$dv3_state_irritated)/4 

#negative affect composite
df$state_NA_composite <- (df$dv3_state_angry +
                          df$dv3_state_annoyed +
                          df$dv3_state_bitter +
                          df$dv3_state_contempt +
                          df$dv3_state_disappointed +
                          df$dv3_state_envy +
                          df$dv3_state_irritated +
                          df$dv3_state_jealous +
                          df$dv3_state_resentful +
                          df$dv3_state_sad +
                          df$dv3_state_shame +
                          df$dv3_state_upset) /12


#negative affect (no envy)
df$state_NA_composite_NoEnvy <- (df$dv3_state_angry +
                                 df$dv3_state_annoyed +
                          
                                 df$dv3_state_contempt +
                                 df$dv3_state_disappointed +
                                  
                                 df$dv3_state_irritated +
                                  
                                  
                                 df$dv3_state_sad +
                                 df$dv3_state_shame +
                                 df$dv3_state_upset) /8

#negative affect composite
df$state_NA_composite <- (df$dv3_state_angry +
                          df$dv3_state_annoyed +
                          df$dv3_state_bitter +
                          df$dv3_state_contempt +
                          df$dv3_state_disappointed +
                          df$dv3_state_envy +
                          df$dv3_state_irritated +
                          df$dv3_state_jealous +
                          df$dv3_state_resentful +
                          df$dv3_state_sad +
                          df$dv3_state_shame +
                          df$dv3_state_upset) /12



#positive affect composite 
df$state_PA_composite <- (df$dv3_state_happy +
                          df$dv3_state_joy +
                          df$dv3_state_surprised +
                          df$dv3_state_thankful +
                          df$dv3_state_compassionate +
                          df$dv3_state_grateful)/6


```

#### Data Visualization

What might we want to visualize?

1.  correlation matrix

```{r correlation_matrix}
library(reshape2)
library(ggplot2)
dv_emotion <- grep("state_", names(df), ignore.case = TRUE, value = TRUE)


emotion_df <- df[, dv_emotion]
emotion_df <- emotion_df[,!(names(emotion_df) %in% "dv2_state_emotion_DO")]

cor_mat <- cor(
  emotion_df,
  use = "pairwise.complete.obs",
  method = "pearson"
)

# melt the correlation matrix
cor_long <- melt(cor_mat)

ggplot(cor_long, aes(Var1, Var2, fill = value)) +
  geom_tile() +
  geom_text(aes(label = round(value, 2)), color = "black", size = 3) +  # show correlations
  scale_fill_gradient2(
    low = "blue", mid = "white", high = "red",
    midpoint = 0, limits = c(-1,1)
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text.y = element_text(size = 8),
    axis.title = element_blank()
  ) +
  labs(fill = "Correlation")


ggplot(df, aes(x = state_envy_composite, y = state_anger_composite)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = TRUE) +
  facet_wrap(~ exp_condition) +
  labs(
    title = "Relationship Between State Envy and State Anger by Condition",
    x = "State Envy Composite (0–6)",
    y = "State Anger Composite (0–6)"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

ggplot(df, aes(
  x = state_envy_composite,
  y = state_anger_composite,
  color = factor(exp_condition)
)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Relationship Between State Envy and State Anger Across Conditions",
    x = "State Envy Composite (0–6)",
    y = "State Anger Composite (0–6)",
    color = "Condition"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))


```

1.  bar plot or box plot for the conditions on envy, anger, and

```{r hypotheses_visualizations}
# visualize state envy 
# envy as a total
ggplot(data = df, aes(x= state_envy_composite))+
  geom_density(fill = "steelblue") +
  labs(
    title = "Envy",
    x = "Envy", 
    y = "Count")+
  theme_minimal()

# state envy by condition
ggplot(data = df, aes(x = factor(exp_condition), y = state_envy_composite, 
                      fill = factor(exp_condition)))+
  geom_boxplot() +
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) + 0.2,
        label = paste0("n = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 4
  ) +
  labs(
    title = "State Envy Across Conditions",
    x = "Conditions",
    y = "Level of State Envy (0-6)", 
    fill = "Condition"
  )+
  theme_minimal() +
  theme(plot.title = element_text(hjust = .5))


# state anger by condition
ggplot(data = df, aes(x = factor(exp_condition), y = state_anger_composite, 
                      fill = factor(exp_condition)))+
  geom_boxplot() +
  stat_summary(
    fun.data = function(x) {
      data.frame(
        y = max(x, na.rm = TRUE) + 0.2,
        label = paste0("n = ", sum(!is.na(x)))
      )
    },
    geom = "text",
    size = 4
  ) +
  labs(
    title = "State Anger Across Conditions",
    x = "Conditions",
    y = "Level of State Anger (0-6)", 
    fill = "Condition"
  )+
  theme_minimal() +
  theme(plot.title = element_text(hjust = .5))


summary_emotion_rations <- df %>%
  group_by(exp_condition) %>%
  summarise(n = n(),
            avg_envy_composite = mean(state_envy_composite, na.rm = T),
            avg_anger_composite = mean(state_anger_composite, na.rm = T),
            avg_money_sacrificed = mean(burn_amount, na.rm = T),
            .groups = "drop")

summary_emotion_rations

# Visualize Money Burning
ggplot(data = df, aes(x = burn_amount)) +
geom_histogram(bins=20)

#money burning by condition
ggplot(data = df, aes(x = burn_amount, fill = factor(exp_condition))) +
  geom_bar() +  
  scale_x_continuous(
    breaks = seq(0, 12, 1),
    limits = c(-0.5, 12.5)
  ) +
  scale_y_continuous(
    breaks = seq(0, 15, 2),
    limits = c(0, 15)
  ) +
  labs(
    title = "Amount Sacrified Across Conditions",
    x = "Sacrafice Amount (¢)",
    y = "Count", 
    fill = "Condition"
    ) +
  theme_minimal() + 
  theme(plot.title = element_text(hjust = 0.5)) 

#money burning by envy 
ggplot(data = df, aes(y = burn_amount, x = state_envy_composite)) + 
  geom_point() +
  geom_smooth(method = "lm") +
  labs(
    title = "The Relationship Between Envy and Money Burning",
    y = "Sacrafice Amount (¢)",
    x = "State Envy Composite (0-6)", 
    ) +
  theme_minimal() + 
  theme(plot.title = element_text(hjust = 0.5))
#money burning by anger 
ggplot(data = df, aes(y = burn_amount, x = state_anger_composite)) + 
  geom_point() +
  geom_smooth(method = "lm") +
  labs(
    title = "The Relationship Between Anger and Money Burning",
    y = "Sacrafice Amount (¢)",
    x = "State Anger Composite (0-6)", 
    ) +
  theme_minimal() + 
  theme(plot.title = element_text(hjust = 0.5))

# money burning by envy and anger on same plot 

# Create a long-format dataframe for overlay
df_long <- df %>%
  pivot_longer(
    cols = c(state_envy_composite, state_anger_composite),
    names_to = "emotion",
    values_to = "score"
  )

ggplot(df_long, aes(x = score, y = burn_amount, color = emotion)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = TRUE) +
  scale_color_manual(
    values = c(
      "state_envy_composite"  = "#1b9e77", 
      "state_anger_composite" = "darkred" 
    ),
    labels = c(
      "state_envy_composite"  = "Envy", 
      "state_anger_composite" = "Anger" 
    )
  )+
  labs(
    title = "Comparing Slopes of Envy vs Anger on Money Burning",
    x = "State Emotion Composite Score (0-6)",
    y = "Sacrifice Amount (¢)",
    color = "Emotion Composite"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

# anger and envy emotion ratings on the same plot (boxplot)
ggplot(df_long, aes(y = score, x = emotion, fill = factor(exp_condition))) + 
  geom_boxplot(position = position_dodge(width = 0.8)) + 
  scale_x_discrete(
    labels = c(
      "state_envy_composite"  = "Envy", 
      "state_anger_composite" = "Anger"
    )) +
  labs(
    title = "State Envy Versus State Anger Across Conditions",
    x = "Emotion Composite",
    y = "Self-Report Ratings (0-6)",
    fill = "Condition"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

# anger and envy emotion ratings on the same plot (violin)
ggplot(df_long, aes(y = score, x = emotion, fill = factor(exp_condition))) + 
  geom_violin() + 
  scale_x_discrete(
    labels = c(
      "state_envy_composite"  = "Envy", 
      "state_anger_composite" = "Anger"
    )) +
  labs(
    title = "State Envy Versus State Anger Across Conditions",
    x = "Emotion Composite",
    y = "Self-Report Ratings (0-6)",
    fill = "Condition"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

# anger and envy emotion ratings on the same plot (bar)
ggplot(df_long, aes(x = emotion, y = score, fill = factor(exp_condition))) + 
  stat_summary(
    fun = mean,
    geom = "col",
    position = position_dodge(width = 0.8)
  ) +
  stat_summary(
    fun.data = mean_se,
    geom = "errorbar",
    width = 0.2,
    position = position_dodge(width = 0.8)
  ) +
  scale_x_discrete(
    labels = c(
      "state_envy_composite"  = "Envy", 
      "state_anger_composite" = "Anger"
    )
  ) +
  labs(
    title = "State Envy Versus State Anger Across Conditions",
    x = "Emotion Composite",
    y = "Mean Self-Report Rating (0–6)",
    fill = "Condition"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))


```

Best way to demo some of the OE data we captured?

```{r wordclouds}
library(ggwordcloud)
library(tidyverse)
library(tidytext)
library(RColorBrewer)

#create a text df
df_text_long <- df %>%
  pivot_longer(
    cols = starts_with("dv1_"),
    names_to = "question",
    values_to = "text"
  )

#remove any stop words 
df_tokens <- df_text_long %>%
  filter(!is.na(text), text != "") %>%
  unnest_tokens(word, text) %>%
  anti_join(stop_words, by = "word") %>%
  filter(!str_detect(word, "^[0-9]+$"))

#custom stop words <-- edit this list as explore the word clouds 
custom_stop <- tibble(
  word = c("like", "sp2", "standard", "player", "treasurer", "ball", "throw", "throwing",
           "pass", "passed", "passes", "threw")
)

df_tokens <- df_tokens %>%
  anti_join(custom_stop, by = "word")

#tokenize
word_counts <- df_tokens %>%
  count(question, exp_condition, word, sort = TRUE)


#oe 1
word_counts %>%
  filter(question == "dv1_oe_sp2_behavior", n >= 1) %>%   # adjust min freq
  ggplot(aes(label = word, size = n)) +
  geom_text_wordcloud() +
  scale_size_area(max_size = 15) +
  theme_minimal() +
  labs(title = "XXX")

word_counts %>%
  filter(question == "dv1_oe_sp2_behavior", n >= 1) %>%
  ggplot(aes(label = word, size = n)) +
  geom_text_wordcloud() +
  scale_size_area(max_size = 12) +
  facet_wrap(~ exp_condition) +
  theme_minimal() +
  labs(title = "XXX")

```

```{r}
df_text <- df[9:15]
df_text$exp_condition <- df$exp_condition
write.csv(df_text, file = "df_text.csv", row.names = FALSE)
```

```{r analyses}
library(lm.beta)
# Conditon on State Envy

summary(lm.beta(lm(state_envy_composite ~ exp_condition, data = df)))

# planned contrasts #

##inequity vs equity ##

##source of equity ##

##responsibility and inequity vs rest ##

# Conditon on State Anger 
# planned contrasts #

##inequity vs equity ##

##source of equity ##

##responsibility and inequity vs rest ##

# Individual Difference on Money Burning 

#overall regression 

## 2-factor test 
# logistic regression --> predict money burning at all
# regress on burners 

# Condition on Money Burning 
# planned contrasts #

##inequity vs equity ##

##source of equity ##

##responsibility and inequity vs rest ##

```
